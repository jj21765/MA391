library(ma391ekang)
f=function(x){((650+5*x)*(-.25-0.01*x)-(140.5+.45*x))*(-1)}
optim(x,f)

growthrate=seq(3,10,1)
ans=0
ans.profitrate=0
for (i in 1:length(growthrate)){
  profitrate=function(x){(650+growthrate[i]*x)*(-.25-0.01*x)-
      (140.5+.45*x)}
  dProfitrate=fprime(profitrate,x)
  ans[i]=bisection(dProfitrate,0,20)
  ans.profitrate[i]=profitrate(ans[i])
}
